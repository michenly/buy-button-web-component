{"version":3,"file":"product-image.js","sourceRoot":"","sources":["../../src/shopify-product/elements/product-image.ts"],"names":[],"mappings":";;;;;;AAAA,OAAO,EAAC,UAAU,EAAE,IAAI,EAAC,MAAM,KAAK,CAAC;AACrC,OAAO,EAAC,aAAa,EAAE,QAAQ,EAAC,MAAM,mBAAmB,CAAC;AAGnD,IAAM,mBAAmB,GAAzB,MAAM,mBAAoB,SAAQ,UAAU;IAOxC,MAAM;QACb,IAAI,IAAI,CAAC,GAAG,EAAE,CAAC;YACb,MAAM,GAAG,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAExC,OAAO,IAAI,CAAA;;;;;iBAKA,IAAI,CAAC,OAAO;;;iBAGZ,GAAG;;aAEP,CAAC;QACV,CAAC;aAAM,CAAC;YACN,OAAO,IAAI,CAAA,EAAE,CAAC;QAChB,CAAC;IACH,CAAC;IAED,OAAO;IACP,yIAAyI;IACzI,2HAA2H;IACnH,YAAY,CAAC,GAAW;QAC9B,MAAM,kBAAkB,GAAG,GAAG,CAAC;QAC/B,MAAM,QAAQ,GAAG,kBAAkB,CAAC;QACpC,MAAM,SAAS,GAAG,kBAAkB,GAAG,GAAG,CAAC;QAE3C,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,CAAC;QAEzB,mCAAmC;QACnC,MAAM,WAAW,GAAG,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAE5C,qEAAqE;QACrE,MAAM,cAAc,GAAG,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC;QAE9C,WAAW,CACT,cAAc,CACf,GAAG,GAAG,WAAW,CAAC,cAAc,CAAC,IAAI,QAAQ,IAAI,SAAS,EAAE,CAAC;QAE9D,GAAG,CAAC,QAAQ,GAAG,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAErC,OAAO,GAAG,CAAC,QAAQ,EAAE,CAAC;IACxB,CAAC;CACF,CAAA;AAjDC;IADC,QAAQ,CAAC,EAAC,IAAI,EAAE,MAAM,EAAC,CAAC;gDACZ;AAGb;IADC,QAAQ,CAAC,EAAC,IAAI,EAAE,MAAM,EAAE,SAAS,EAAE,UAAU,EAAC,CAAC;oDAC/B;AALN,mBAAmB;IAD/B,aAAa,CAAC,eAAe,CAAC;GAClB,mBAAmB,CAmD/B","sourcesContent":["import {LitElement, html} from 'lit';\nimport {customElement, property} from 'lit/decorators.js';\n\n@customElement('product-image')\nexport class ProductImageElement extends LitElement {\n  @property({type: String})\n  url?: string;\n\n  @property({type: String, attribute: 'alt-text'})\n  altText?: string;\n\n  override render() {\n    if (this.url) {\n      const src = this.imageForSize(this.url);\n\n      return html`<div\n        class=\"shopify-buy__product-img-wrapper\"\n        data-element=\"product.imgWrapper\"\n      >\n        <img\n          alt=\"${this.altText}\"\n          data-element=\"product.img\"\n          class=\"shopify-buy__product__variant-img\"\n          src=\"${src}\"\n        />\n      </div>`;\n    } else {\n      return html``;\n    }\n  }\n\n  // From\n  // buy-button-js: https://github.com/Shopify/buy-button-js/blob/0b19fdeaa15e5fcb47bb67d7a4a3454bda2caa43/src/components/product.js#L114 &\n  // JS-BUY-SDK: https://github.com/Shopify/js-buy-sdk/blob/bdd3dd75a667742695ae6c0991eabff3cd24f4d4/src/image-helpers.js#L21\n  private imageForSize(url: string) {\n    const DEFAULT_IMAGE_SIZE = 550;\n    const maxWidth = DEFAULT_IMAGE_SIZE;\n    const maxHeight = DEFAULT_IMAGE_SIZE * 1.5;\n\n    const src = new URL(url);\n\n    // Use the section before the query\n    const imageTokens = src.pathname.split('.');\n\n    // Take the token before the file extension and append the dimensions\n    const imagePathIndex = imageTokens.length - 2;\n\n    imageTokens[\n      imagePathIndex\n    ] = `${imageTokens[imagePathIndex]}_${maxWidth}x${maxHeight}`;\n\n    src.pathname = imageTokens.join('.');\n\n    return src.toString();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'product-image': ProductImageElement;\n  }\n}\n"]}